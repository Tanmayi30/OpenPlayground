<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Debris ¬∑ Tracking & Collision Risk</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'IBM Plex Mono', 'Space Mono', monospace;
            background-color: #03030c;
            color: #eef;
        }
        #debris-header {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 50;
            background: rgba(0, 5, 15, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid #6a4e9f;
            border-radius: 60px;
            padding: 12px 32px;
            display: flex;
            gap: 35px;
            box-shadow: 0 15px 35px rgba(30,0,60,0.6);
            border-left: 5px solid #b380ff;
        }
        .stat-block {
            display: flex;
            flex-direction: column;
        }
        .stat-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            color: #b8a0ff;
            letter-spacing: 1px;
        }
        .stat-number {
            font-size: 1.7rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ffffff, #d9b0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
        }
        #risk-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(20, 0, 30, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid #ff5599;
            border-radius: 40px;
            padding: 16px 28px;
            z-index: 50;
            border-right: 6px solid #ff3377;
            min-width: 260px;
        }
        .risk-title {
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        .risk-indicator {
            width: 16px;
            height: 16px;
            background: #ff3355;
            border-radius: 50%;
            box-shadow: 0 0 25px #ff3355;
            animation: risk-pulse 1.2s infinite;
        }
        @keyframes risk-pulse {
            0% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); background: #ff6688; }
            100% { opacity: 0.6; transform: scale(1); }
        }
        .risk-bar {
            width: 100%;
            height: 8px;
            background: #330033;
            border-radius: 10px;
            margin: 10px 0;
        }
        .risk-fill {
            width: 34%;
            height: 8px;
            background: linear-gradient(90deg, #ffaa66, #ff4466);
            border-radius: 10px;
        }
        .debris-legend {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: rgba(5, 5, 20, 0.8);
            backdrop-filter: blur(6px);
            border: 1px solid #6a4daa;
            border-radius: 40px;
            padding: 14px 28px;
            z-index: 50;
            font-size: 0.9rem;
        }
        .legend-color {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }
        .bottom-right-stats {
            position: absolute;
            bottom: 25px;
            right: 25px;
            background: rgba(8, 8, 24, 0.9);
            backdrop-filter: blur(8px);
            border: 1px solid #7a5ac0;
            border-radius: 36px;
            padding: 18px 28px;
            z-index: 50;
            text-align: right;
            border-bottom: 4px solid #b380ff;
        }
        .highlight {
            color: #ffb07c;
            font-weight: bold;
        }
        .warning-flash {
            animation: textflash 2s infinite;
        }
        @keyframes textflash {
            0% { color: #ffaa88; }
            50% { color: #ff5577; text-shadow: 0 0 10px #ff3377; }
            100% { color: #ffaa88; }
        }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="debris-header">
        <div class="stat-block">
            <span class="stat-label">TRACKED OBJECTS</span>
            <span class="stat-number" id="debris-count">23,204</span>
        </div>
        <div class="stat-block">
            <span class="stat-label">FRAGMENTS >10cm</span>
            <span class="stat-number" id="frag-count">16,890</span>
        </div>
        <div class="stat-block">
            <span class="stat-label">ACTIVE SATS</span>
            <span class="stat-number">4,857</span>
        </div>
    </div>

    <div id="risk-panel">
        <div class="risk-title">
            <span class="risk-indicator"></span> <span style="color:#ffb0dd;">COLLISION RISK (LEO)</span>
        </div>
        <div style="display: flex; justify-content: space-between;">
            <span>Conjunction alert</span> <span class="highlight" id="conjunction-id">SCC #4532</span>
        </div>
        <div style="display: flex; justify-content: space-between; margin: 6px 0;">
            <span>Probability</span> <span id="collision-prob" class="warning-flash">3.4%</span>
        </div>
        <div class="risk-bar">
            <div class="risk-fill" style="width:34%;"></div>
        </div>
        <div style="display: flex; justify-content: space-between; font-size:0.85rem;">
            <span>‚è±Ô∏è TCA: 14:32:19</span> <span>‚¨áÔ∏è 842 km</span>
        </div>
        <div style="margin-top:12px; background:#220022; border-radius:30px; padding:6px 12px; font-size:0.8rem;">
            üõ∞Ô∏è Involved: IRAS (deorbited) ¬∑ SL-8 R/B
        </div>
    </div>

    <div class="debris-legend">
        <span><span class="legend-color" style="background:#88aaff;"></span> Active satellites</span>
        <span style="margin-left:20px;"><span class="legend-color" style="background:#ff9966;"></span> Debris (LOW)</span>
        <span style="margin-left:20px;"><span class="legend-color" style="background:#ff4466;"></span> High-risk fragment</span>
        <span style="margin-left:20px;"><span class="legend-color" style="background:#aaaaaa;"></span> Rocket bodies</span>
    </div>

    <div class="bottom-right-stats">
        <div style="font-size:1rem;">üú® LEO CROWDING</div>
        <div style="font-size:2rem; font-weight:700; background: linear-gradient(135deg,#ffa07a,#ff7b9c); -webkit-background-clip:text; -webkit-text-fill-color:transparent;">78%</div>
        <div style="font-size:0.8rem; color:#ccaaff;">shell 800‚Äì1000 km at risk</div>
        <div style="margin-top:10px;">‚ö†Ô∏è 3 conjunctions next hour</div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';
        
        // --- Scene setup ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x030310);
        
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(20, 8, 25);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.body.appendChild(renderer.domElement);
        
        const labelRenderer = new CSS2DRenderer();
        labelRenderer.setSize(window.innerWidth, window.innerHeight);
        labelRenderer.domElement.style.position = 'absolute';
        labelRenderer.domElement.style.top = '0';
        labelRenderer.domElement.style.left = '0';
        labelRenderer.domElement.style.pointerEvents = 'none';
        document.body.appendChild(labelRenderer.domElement);
        
        // --- Controls ---
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.06;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.8;
        controls.maxDistance = 50;
        controls.minDistance = 12;
        
        // --- Lighting ---
        const ambient = new THREE.AmbientLight(0x303050);
        scene.add(ambient);
        
        const sunLight = new THREE.DirectionalLight(0xffeedd, 1.2);
        sunLight.position.set(15, 15, 10);
        scene.add(sunLight);
        
        const fillLight = new THREE.DirectionalLight(0x7799cc, 0.4);
        fillLight.position.set(-10, -5, 15);
        scene.add(fillLight);
        
        // --- Stars ---
        const starsGeo = new THREE.BufferGeometry();
        const starsCount = 4000;
        const starsPos = new Float32Array(starsCount * 3);
        for (let i = 0; i < starsCount*3; i+=3) {
            const r = 120 + Math.random() * 80;
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos(2*Math.random() - 1);
            starsPos[i] = Math.sin(phi) * Math.cos(theta) * r;
            starsPos[i+1] = Math.sin(phi) * Math.sin(theta) * r;
            starsPos[i+2] = Math.cos(phi) * r;
        }
        starsGeo.setAttribute('position', new THREE.BufferAttribute(starsPos, 3));
        const starsMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.2 });
        const stars = new THREE.Points(starsGeo, starsMat);
        scene.add(stars);
        
        // --- Earth ---
        const texLoader = new THREE.TextureLoader();
        const earthMap = texLoader.load('https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg');
        const earthSpec = texLoader.load('https://threejs.org/examples/textures/planets/earth_specular_2048.jpg');
        const earthNorm = texLoader.load('https://threejs.org/examples/textures/planets/earth_normal_2048.jpg');
        const cloudMap = texLoader.load('https://threejs.org/examples/textures/planets/earth_clouds_1024.png');
        
        const earthGeo = new THREE.SphereGeometry(5, 80, 80);
        const earthMat = new THREE.MeshPhongMaterial({ map: earthMap, specularMap: earthSpec, specular: 0x333333, normalMap: earthNorm });
        const earth = new THREE.Mesh(earthGeo, earthMat);
        earth.rotation.y = 3.2;
        scene.add(earth);
        
        const cloudGeo = new THREE.SphereGeometry(5.03, 80, 80);
        const cloudMat = new THREE.MeshPhongMaterial({ map: cloudMap, transparent: true, opacity: 0.2, blending: THREE.AdditiveBlending, side: THREE.DoubleSide });
        const clouds = new THREE.Mesh(cloudGeo, cloudMat);
        clouds.rotation.y = 3.2;
        scene.add(clouds);
        
        const atmosGeo = new THREE.SphereGeometry(5.15, 64, 64);
        const atmosMat = new THREE.MeshPhongMaterial({ color: 0x3366aa, transparent: true, opacity: 0.07, side: THREE.BackSide });
        const atmos = new THREE.Mesh(atmosGeo, atmosMat);
        scene.add(atmos);
        
        // --- Debris field generation ---
        const debrisGroup = [];
        const debrisPositions = [];
        
        // Parameters
        const layers = [
            { alt: 5.8, count: 600, color: 0xff9966, size: 0.1 },   // low debris
            { alt: 6.2, count: 450, color: 0xff4466, size: 0.15 },  // high-risk fragments
            { alt: 6.6, count: 300, color: 0xaaaaaa, size: 0.12 },  // rocket bodies
            { alt: 7.0, count: 200, color: 0x88aaff, size: 0.08 }   // active satellites (blue)
        ];
        
        // Also create some random orbits with inclinations
        layers.forEach(layer => {
            for (let i = 0; i < layer.count; i++) {
                // Random position on sphere at given altitude
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1); // spherical uniform
                
                const r = layer.alt;
                const x = r * Math.sin(phi) * Math.cos(theta);
                const y = r * Math.sin(phi) * Math.sin(theta) * 0.7; // flatten to simulate inclination grouping
                const z = r * Math.cos(phi);
                
                const pos = new THREE.Vector3(x, y, z);
                
                // Create tiny sphere
                const geo = new THREE.SphereGeometry(layer.size * (0.5 + Math.random()*0.5), 4);
                const mat = new THREE.MeshStandardMaterial({ color: layer.color, emissive: layer.color, emissiveIntensity: 0.2 });
                const sphere = new THREE.Mesh(geo, mat);
                sphere.position.copy(pos);
                scene.add(sphere);
                
                debrisGroup.push({ mesh: sphere, pos: pos.clone(), alt: layer.alt, color: layer.color });
                debrisPositions.push(pos.clone());
            }
        });
        
        // Add some "high-risk" highlighted debris with trails? Not necessary.
        
        // Create a few orbital paths (lines) for context
        function createOrbitRing(alt, color, inclination = 0.2) {
            const points = [];
            for (let i = 0; i <= 64; i++) {
                const angle = (i / 64) * Math.PI * 2;
                const base = new THREE.Vector3(alt * Math.cos(angle), 0, alt * Math.sin(angle));
                // rotate by inclination
                const rot = new THREE.Matrix4().makeRotationX(inclination);
                base.applyMatrix4(rot);
                points.push(base);
            }
            const geo = new THREE.BufferGeometry().setFromPoints(points);
            const mat = new THREE.LineBasicMaterial({ color: color, transparent: true, opacity: 0.1 });
            const line = new THREE.LineLoop(geo, mat);
            scene.add(line);
        }
        
        createOrbitRing(5.8, 0xff9966, 0.3);
        createOrbitRing(6.2, 0xff4466, 0.5);
        createOrbitRing(6.6, 0xaaaaaa, 0.4);
        createOrbitRing(7.0, 0x88aaff, 0.2);
        
        // --- Conjunction highlight (two objects approaching) ---
        // Create two specific debris pieces that are "risky"
        const risky1Pos = new THREE.Vector3(6.1 * Math.cos(2.3), 1.2, 6.1 * Math.sin(2.3));
        const risky2Pos = new THREE.Vector3(6.2 * Math.cos(2.35), -0.9, 6.2 * Math.sin(2.35));
        
        const riskyGeo = new THREE.SphereGeometry(0.25, 8);
        const riskyMat = new THREE.MeshStandardMaterial({ color: 0xff0000, emissive: 0x550000 });
        const risky1 = new THREE.Mesh(riskyGeo, riskyMat);
        risky1.position.copy(risky1Pos);
        scene.add(risky1);
        
        const risky2 = new THREE.Mesh(riskyGeo, riskyMat);
        risky2.position.copy(risky2Pos);
        scene.add(risky2);
        
        // Add pulsing glow around them (sprites)
        function createGlowSprite(color) {
            const canvas = document.createElement('canvas');
            canvas.width = 32;
            canvas.height = 32;
            const ctx = canvas.getContext('2d');
            const gradient = ctx.createRadialGradient(16, 16, 0, 16, 16, 16);
            gradient.addColorStop(0, 'rgba(255,100,100,1)');
            gradient.addColorStop(0.6, 'rgba(255,0,0,0.4)');
            gradient.addColorStop(1, 'rgba(255,0,0,0)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 32, 32);
            const texture = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({ map: texture, blending: THREE.AdditiveBlending });
            const sprite = new THREE.Sprite(material);
            sprite.scale.set(1.2, 1.2, 1);
            return sprite;
        }
        
        const glow1 = createGlowSprite(0xff0000);
        glow1.position.copy(risky1Pos);
        scene.add(glow1);
        
        const glow2 = createGlowSprite(0xff0000);
        glow2.position.copy(risky2Pos);
        scene.add(glow2);
        
        // Add line between them to show conjunction
        const conjGeo = new THREE.BufferGeometry().setFromPoints([risky1Pos, risky2Pos]);
        const conjMat = new THREE.LineBasicMaterial({ color: 0xff5555, transparent: true, opacity: 0.8 });
        const conjLine = new THREE.Line(conjGeo, conjMat);
        scene.add(conjLine);
        
        // Labels for risky objects
        const label1Div = document.createElement('div');
        label1Div.textContent = '‚õî SL-8 R/B';
        label1Div.style.background = '#330000';
        label1Div.style.color = '#ff8888';
        label1Div.style.border = '1px solid red';
        label1Div.style.borderRadius = '20px';
        label1Div.style.padding = '2px 12px';
        label1Div.style.fontSize = '12px';
        const label1 = new CSS2DObject(label1Div);
        label1.position.copy(risky1Pos.clone().multiplyScalar(1.02));
        scene.add(label1);
        
        const label2Div = document.createElement('div');
        label2Div.textContent = '‚ö†Ô∏è IRAS';
        label2Div.style.background = '#330000';
        label2Div.style.color = '#ff8888';
        label2Div.style.border = '1px solid red';
        label2Div.style.borderRadius = '20px';
        label2Div.style.padding = '2px 12px';
        label2Div.style.fontSize = '12px';
        const label2 = new CSS2DObject(label2Div);
        label2.position.copy(risky2Pos.clone().multiplyScalar(1.02));
        scene.add(label2);
        
        // --- Animate debris (simple rotation) ---
        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate debris cloud slightly? Could just let camera rotate.
            // But we can rotate the risky objects to simulate orbit
            const time = Date.now() * 0.001;
            
            // Move risky objects in a small arc to show approaching
            risky1.position.x = 6.1 * Math.cos(time * 0.3 + 2.0);
            risky1.position.z = 6.1 * Math.sin(time * 0.3 + 2.0);
            risky1.position.y = 1.1 * Math.sin(time * 0.5);
            
            risky2.position.x = 6.2 * Math.cos(time * 0.31 + 2.1);
            risky2.position.z = 6.2 * Math.sin(time * 0.31 + 2.1);
            risky2.position.y = -0.9 * Math.sin(time * 0.4 + 1.2);
            
            glow1.position.copy(risky1.position);
            glow2.position.copy(risky2.position);
            label1.position.copy(risky1.position.clone().multiplyScalar(1.02));
            label2.position.copy(risky2.position.clone().multiplyScalar(1.02));
            
            // Update conjunction line
            const points = [risky1.position.clone(), risky2.position.clone()];
            conjLine.geometry.dispose();
            conjLine.geometry = new THREE.BufferGeometry().setFromPoints(points);
            
            // Rotate clouds
            clouds.rotation.y += 0.0002;
            
            controls.update();
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }
        
        animate();
        
        // Update stats occasionally
        setInterval(() => {
            document.getElementById('collision-prob').innerHTML = (Math.random() * 5 + 1.2).toFixed(1) + '%';
            document.getElementById('conjunction-id').innerText = 'SCC #' + Math.floor(Math.random()*9000+1000);
        }, 5000);
        
        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>